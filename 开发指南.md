# 说唱音乐专辑论坛 - 开发指南

## 快速开始

### 1. 安装依赖
```bash
npm install
```

### 2. 启动开发服务器
```bash
npm run dev
```

开发服务器将在 http://localhost:3000 启动

### 3. 构建生产版本
```bash
npm run build
```

## 项目架构说明

### 目录结构详解

```
src/
├── api/              # API接口层
│   ├── request.ts    # Axios封装，请求/响应拦截器
│   ├── user.ts       # 用户相关接口
│   ├── album.ts      # 专辑相关接口
│   └── forum.ts      # 论坛相关接口
│
├── assets/           # 静态资源
│   └── styles/       # 样式文件
│       └── main.scss # 全局样式，包含变量、通用类
│
├── components/       # 公共组件（待开发）
│   ├── common/       # 通用组件（按钮、输入框等）
│   └── business/     # 业务组件（专辑卡片、评论组件等）
│
├── router/           # 路由配置
│   └── index.ts      # 路由定义和路由守卫
│
├── stores/           # Pinia状态管理
│   ├── user.ts       # 用户状态（登录信息、权限等）
│   ├── album.ts      # 专辑状态（列表、收藏等）
│   └── forum.ts      # 论坛状态（帖子、通知等）
│
├── types/            # TypeScript类型定义
│   ├── user.ts       # 用户相关类型
│   ├── album.ts      # 专辑相关类型
│   ├── forum.ts      # 论坛相关类型
│   └── common.ts     # 通用类型
│
├── utils/            # 工具函数
│   ├── format.ts     # 格式化函数（日期、时长等）
│   ├── validate.ts   # 表单验证函数
│   └── storage.ts    # 本地存储封装
│
├── views/            # 页面组件
│   ├── Home/         # 首页
│   ├── Album/        # 专辑相关页面
│   ├── Forum/        # 论坛相关页面
│   ├── User/         # 用户相关页面
│   └── Admin/        # 管理后台页面
│
├── App.vue           # 根组件
└── main.ts           # 应用入口
```

## 核心技术说明

### 1. Vue 3 Composition API

项目使用Vue 3的Composition API和`<script setup>`语法糖：

```vue
<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'

// 响应式数据
const count = ref(0)

// 计算属性
const doubleCount = computed(() => count.value * 2)

// 生命周期
onMounted(() => {
  console.log('组件已挂载')
})
</script>
```

### 2. TypeScript 类型系统

所有数据结构都有完整的类型定义：

```typescript
// 定义接口
interface User {
  id: string
  username: string
  email: string
}

// 使用类型
const user: User = {
  id: '1',
  username: 'test',
  email: 'test@example.com'
}
```

### 3. Pinia 状态管理

使用Pinia进行全局状态管理：

```typescript
// 定义store
export const useUserStore = defineStore('user', () => {
  const userInfo = ref<User | null>(null)
  
  function setUserInfo(user: User) {
    userInfo.value = user
  }
  
  return { userInfo, setUserInfo }
})

// 使用store
const userStore = useUserStore()
userStore.setUserInfo(userData)
```

### 4. Vue Router 路由管理

路由配置支持懒加载和路由守卫：

```typescript
{
  path: '/album/:id',
  name: 'AlbumDetail',
  component: () => import('@/views/Album/AlbumDetail.vue'),
  meta: { title: '专辑详情', requiresAuth: true }
}
```

### 5. Axios HTTP请求

统一的请求封装，自动处理token和错误：

```typescript
// 发起请求
const data = await request.get('/albums', { page: 1 })
```

## 开发规范

### 1. 命名规范

- **组件文件**: PascalCase (如 `AlbumCard.vue`)
- **普通文件**: kebab-case (如 `format-date.ts`)
- **变量/函数**: camelCase (如 `getUserInfo`)
- **常量**: UPPER_SNAKE_CASE (如 `API_BASE_URL`)
- **类型/接口**: PascalCase (如 `User`, `AlbumDetail`)

### 2. 代码注释

为所有复杂逻辑添加注释：

```typescript
/**
 * 格式化日期时间
 * @param date 日期字符串或Date对象
 * @param format 格式化模板
 * @returns 格式化后的日期字符串
 */
export function formatDate(date: string | Date, format: string): string {
  // 实现...
}
```

### 3. 组件开发

- 单个组件不超过300行，超过则拆分
- 合理使用组合式函数（Composables）抽取逻辑
- Props定义完整的TypeScript类型
- 使用`defineEmits`定义事件

### 4. 样式规范

- 使用SCSS编写样式
- 组件样式使用`scoped`避免污染
- 使用全局样式变量保持一致性
- 遵循BEM命名规范（可选）

```vue
<style lang="scss" scoped>
.album-card {
  &__title {
    font-size: 16px;
  }
  
  &__cover {
    width: 100%;
  }
}
</style>
```

## API对接说明

### 请求格式

所有请求都会自动添加：
- `Content-Type: application/json`
- `Authorization: Bearer ${token}` (如果已登录)

### 响应格式

后端API应返回统一格式：

```typescript
{
  code: 200,        // 状态码
  message: "成功",  // 消息
  data: {           // 数据
    // ...
  }
}
```

### 错误处理

- `401`: 自动跳转登录页
- `403`: 提示权限不足
- `404`: 提示资源不存在
- `500`: 提示服务器错误

## 环境变量

在`.env.development`和`.env.production`中配置：

```
VITE_APP_TITLE=说唱音乐专辑论坛
VITE_APP_BASE_API=/api
```

使用方式：
```typescript
const apiUrl = import.meta.env.VITE_APP_BASE_API
```

## 调试技巧

### 1. Vue DevTools
安装Vue DevTools浏览器插件，可以：
- 查看组件树
- 检查组件状态
- 查看Pinia store
- 追踪路由变化

### 2. 网络请求调试
使用浏览器开发者工具Network面板：
- 查看请求/响应数据
- 检查请求头
- 查看响应时间

### 3. 日志输出
在开发环境使用`console.log`调试：
```typescript
console.log('用户信息:', userInfo)
console.error('错误:', error)
```

## 常见问题

### Q: 如何添加新页面？

1. 在`src/views`下创建页面组件
2. 在`src/router/index.ts`中添加路由配置
3. 在导航菜单中添加链接

### Q: 如何调用API接口？

1. 在`src/api`对应模块中定义接口函数
2. 在组件中导入并调用
3. 使用try-catch处理错误

```typescript
import { getAlbumList } from '@/api/album'

async function loadAlbums() {
  try {
    const data = await getAlbumList({ page: 1 })
    albums.value = data.list
  } catch (error) {
    console.error('加载失败:', error)
  }
}
```

### Q: 如何添加全局状态？

1. 在`src/stores`下创建store文件
2. 使用`defineStore`定义状态和方法
3. 在组件中使用store

### Q: 如何处理用户权限？

在路由配置中使用`meta`字段：
```typescript
{
  path: '/admin',
  meta: { requiresAuth: true, requiresAdmin: true }
}
```

路由守卫会自动检查权限。

## 性能优化建议

1. **路由懒加载**: 已实现，保持使用
2. **组件按需引入**: Element Plus已配置按需引入
3. **图片懒加载**: 待实现
4. **虚拟列表**: 长列表使用虚拟滚动
5. **代码分割**: 使用动态import
6. **防抖节流**: 搜索、滚动等使用防抖节流

## 下一步开发计划

### 阶段一：核心功能（2-3周）
- [ ] 完善专辑列表和详情页
- [ ] 实现音乐播放器组件
- [ ] 完成论坛帖子功能
- [ ] 实现评论系统

### 阶段二：用户功能（1-2周）
- [ ] 个人主页
- [ ] 收藏和历史记录
- [ ] 消息通知
- [ ] 用户设置

### 阶段三：管理功能（1-2周）
- [ ] 管理后台页面
- [ ] 内容管理
- [ ] 用户管理
- [ ] 数据统计

### 阶段四：优化和测试（1周）
- [ ] 性能优化
- [ ] 响应式适配
- [ ] 单元测试
- [ ] 用户体验优化

## 技术支持

如遇到问题，可以：
1. 查阅[Vue.js官方文档](https://cn.vuejs.org/)
2. 查阅[Element Plus文档](https://element-plus.org/)
3. 查阅[TypeScript文档](https://www.typescriptlang.org/)
4. 查看项目中的代码注释

---

**祝你开发顺利！🎉**

