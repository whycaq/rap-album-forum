# é¡¹ç›®æ¶æ„ä¼˜åŒ–è¯´æ˜

æ ¹æ®cursorrulesçš„è¦æ±‚ï¼Œå¯¹é¡¹ç›®æ¶æ„è¿›è¡Œäº†å…¨é¢ä¼˜åŒ–å’Œå®Œå–„ã€‚

## ğŸ“‹ ä¼˜åŒ–å†…å®¹

### 1. ç½‘ç»œè¯·æ±‚è§„èŒƒ âœ…

#### å¢å¼ºçš„HTTPå®¢æˆ·ç«¯ (`src/api/request.ts`)

**æ–°å¢åŠŸèƒ½ï¼š**

1. **è¯·æ±‚æ‹¦æˆªå™¨å¢å¼º**
   - âœ… è‡ªåŠ¨æ·»åŠ è®¤è¯token
   - âœ… è‡ªåŠ¨æ·»åŠ å…¬å…±å‚æ•°
   - âœ… è¯·æ±‚æ€§èƒ½ç›‘æ§ï¼ˆè®°å½•è€—æ—¶ï¼‰
   - âœ… è¯·æ±‚ç¼“å­˜æœºåˆ¶ï¼ˆGETè¯·æ±‚è‡ªåŠ¨ç¼“å­˜5åˆ†é’Ÿï¼‰
   - âœ… è¯·æ±‚å»é‡ï¼ˆè‡ªåŠ¨å–æ¶ˆé‡å¤è¯·æ±‚ï¼‰

2. **å“åº”æ‹¦æˆªå™¨å¢å¼º**
   - âœ… ç»Ÿä¸€é”™è¯¯ç å¤„ç†
   - âœ… è¯·æ±‚é‡è¯•æœºåˆ¶ï¼ˆç½‘ç»œé”™è¯¯è‡ªåŠ¨é‡è¯•2æ¬¡ï¼‰
   - âœ… æ€§èƒ½ç›‘æ§å’Œæ…¢è¯·æ±‚è­¦å‘Š
   - âœ… ç¼“å­˜ç®¡ç†

3. **è¯·æ±‚æ–¹æ³•æ‰©å±•**
   ```typescript
   request.get()      // GETè¯·æ±‚ï¼ˆè‡ªåŠ¨ç¼“å­˜ï¼‰
   request.post()     // POSTè¯·æ±‚
   request.put()      // PUTè¯·æ±‚
   request.delete()   // DELETEè¯·æ±‚
   request.upload()   // æ–‡ä»¶ä¸Šä¼ ï¼ˆå¸¦è¿›åº¦ï¼‰
   ```

4. **å·¥å…·å‡½æ•°**
   ```typescript
   clearCache()                    // æ¸…é™¤æ‰€æœ‰ç¼“å­˜
   cancelAllRequests()             // å–æ¶ˆæ‰€æœ‰å¾…å¤„ç†è¯·æ±‚
   getRequestMetrics()             // è·å–æ€§èƒ½æŒ‡æ ‡
   getAverageRequestDuration()     // è·å–å¹³å‡è¯·æ±‚æ—¶é•¿
   getRequestSuccessRate()         // è·å–è¯·æ±‚æˆåŠŸç‡
   ```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```typescript
// å¸¦æ€§èƒ½ç›‘æ§çš„è¯·æ±‚
const data = await request.get('/albums', { page: 1 })

// æ–‡ä»¶ä¸Šä¼ å¸¦è¿›åº¦
await request.upload('/upload', file, (progress) => {
  console.log(`ä¸Šä¼ è¿›åº¦: ${progress}%`)
})

// æŸ¥çœ‹æ€§èƒ½æŒ‡æ ‡
console.log('å¹³å‡è¯·æ±‚æ—¶é•¿:', getAverageRequestDuration())
console.log('è¯·æ±‚æˆåŠŸç‡:', getRequestSuccessRate())
```

---

### 2. ç»„ä»¶å°è£…è§„èŒƒ âœ…

#### åˆ›å»ºçš„ç»„ä»¶ç¤ºä¾‹

##### é€šç”¨ç»„ä»¶ (`src/components/common/`)

**BaseButton.vue** - åŸºç¡€æŒ‰é’®ç»„ä»¶
- âœ… éµå¾ªå•ä¸€èŒè´£åŸåˆ™
- âœ… å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- âœ… Propsä¼ é€’æ•°æ®
- âœ… Emitsäº‹ä»¶é€šä¿¡
- âœ… æ”¯æŒæ’æ§½æ‰©å±•
- âœ… å®Œæ•´çš„ç»„ä»¶æ–‡æ¡£
- âœ… æ”¯æŒå¤šç§ç±»å‹å’Œå°ºå¯¸
- âœ… åŠ è½½çŠ¶æ€å’Œç¦ç”¨çŠ¶æ€

```vue
<BaseButton type="primary" :loading="loading" @click="submit">
  <template #icon><el-icon><Check /></el-icon></template>
  æäº¤
</BaseButton>
```

##### ä¸šåŠ¡ç»„ä»¶ (`src/components/business/`)

**AlbumCard.vue** - ä¸“è¾‘å¡ç‰‡ç»„ä»¶
- âœ… ä¸šåŠ¡é€»è¾‘å°è£…
- âœ… Propså®šä¹‰å®Œæ•´
- âœ… äº‹ä»¶emitæ¸…æ™°
- âœ… å¤šä¸ªæ’æ§½æ”¯æŒï¼ˆoverlayã€badgeã€extraï¼‰
- âœ… å›¾ç‰‡åŠ è½½å¤±è´¥å¤„ç†
- âœ… æ‚¬åœæ•ˆæœ
- âœ… å“åº”å¼è®¾è®¡

```vue
<AlbumCard :album="data" @click="goToDetail">
  <template #badge><span>ğŸ”¥</span></template>
  <template #extra><div>æ”¶è—: 1000</div></template>
</AlbumCard>
```

#### ç»„ä»¶å¼€å‘è§„èŒƒ

1. **å‘½åè§„èŒƒ**
   - ç»„ä»¶åï¼šPascalCaseï¼ˆå¦‚AlbumCardï¼‰
   - Propsï¼šcamelCaseï¼ˆå¦‚showRatingï¼‰
   - Eventsï¼škebab-caseï¼ˆå¦‚album-clickï¼‰

2. **æ–‡ä»¶ç»“æ„**
   ```
   components/
   â”œâ”€â”€ common/          # é€šç”¨åŸºç¡€ç»„ä»¶
   â”‚   â”œâ”€â”€ BaseButton.vue
   â”‚   â””â”€â”€ README.md    # ç»„ä»¶æ–‡æ¡£
   â””â”€â”€ business/        # ä¸šåŠ¡ç»„ä»¶
       â”œâ”€â”€ AlbumCard.vue
       â””â”€â”€ README.md
   ```

3. **ç±»å‹å®šä¹‰**
   ```typescript
   interface Props {
     /** å®Œæ•´çš„JSDocæ³¨é‡Š */
     album: Album
   }
   
   interface Emits {
     /** ç‚¹å‡»äº‹ä»¶ */
     (e: 'click', id: string): void
   }
   ```

---

### 3. ç»„åˆå¼å‡½æ•° (Composables) âœ…

#### æ–°å¢çš„Composables (`src/composables/`)

##### useRequest
é€šç”¨è¯·æ±‚Hookï¼Œè‡ªåŠ¨ç®¡ç†loadingå’Œé”™è¯¯çŠ¶æ€
```typescript
const { data, loading, error, execute } = useRequest(getAlbumList)
await execute({ page: 1 })
```

##### usePagination
åˆ†é¡µè¯·æ±‚Hook
```typescript
const { list, page, total, load, changePage } = usePagination(getAlbumList)
await load()  // åŠ è½½ç¬¬ä¸€é¡µ
changePage(2) // åˆ‡æ¢åˆ°ç¬¬2é¡µ
```

##### useDebounce / useSearch
é˜²æŠ–å’Œæœç´¢Hook
```typescript
const { keyword, results, search } = useSearch(searchAlbums, 500)
search('è¯´å”±') // è‡ªåŠ¨é˜²æŠ–æœç´¢
```

##### useDialog
å¯¹è¯æ¡†ç®¡ç†Hook
```typescript
const { visible, open, close } = useDialog()
open()  // æ‰“å¼€å¯¹è¯æ¡†
close() // å…³é—­å¯¹è¯æ¡†
```

##### useClipboard
å‰ªè´´æ¿æ“ä½œHook
```typescript
const { copy, copied } = useClipboard()
await copy('å¤åˆ¶çš„æ–‡æœ¬')
console.log(copied.value) // true
```

**ä¼˜åŠ¿ï¼š**
- âœ… é€»è¾‘å¤ç”¨
- âœ… ä»£ç ç»„ç»‡æ¸…æ™°
- âœ… ç±»å‹å®‰å…¨
- âœ… æ˜“äºæµ‹è¯•

---

### 4. é¡¹ç›®ç»“æ„ä¼˜åŒ– âœ…

#### æ–°çš„ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ api/              # APIæ¥å£å±‚ï¼ˆå·²ä¼˜åŒ–ï¼‰
â”‚   â”œâ”€â”€ request.ts    # âœ¨ å¢å¼ºçš„HTTPå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ user.ts
â”‚   â”œâ”€â”€ album.ts
â”‚   â””â”€â”€ forum.ts
â”‚
â”œâ”€â”€ composables/      # âœ¨ æ–°å¢ï¼šç»„åˆå¼å‡½æ•°
â”‚   â”œâ”€â”€ useRequest.ts
â”‚   â”œâ”€â”€ useDebounce.ts
â”‚   â”œâ”€â”€ useDialog.ts
â”‚   â”œâ”€â”€ useClipboard.ts
â”‚   â””â”€â”€ index.ts
â”‚
â”œâ”€â”€ components/       # âœ¨ æ–°å¢ï¼šå…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ common/       # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ BaseButton.vue
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â””â”€â”€ business/     # ä¸šåŠ¡ç»„ä»¶
â”‚       â”œâ”€â”€ AlbumCard.vue
â”‚       â””â”€â”€ README.md
â”‚
â”œâ”€â”€ stores/           # çŠ¶æ€ç®¡ç†
â”œâ”€â”€ types/            # ç±»å‹å®šä¹‰
â”œâ”€â”€ utils/            # å·¥å…·å‡½æ•°
â”œâ”€â”€ views/            # é¡µé¢ç»„ä»¶
â”œâ”€â”€ router/           # è·¯ç”±é…ç½®
â””â”€â”€ assets/           # é™æ€èµ„æº
```

---

## ğŸ¯ ä¼˜åŒ–æ•ˆæœ

### 1. ç½‘ç»œè¯·æ±‚å±‚é¢
- âœ… **æ€§èƒ½æå‡**ï¼šè¯·æ±‚ç¼“å­˜å‡å°‘é‡å¤è¯·æ±‚
- âœ… **ç”¨æˆ·ä½“éªŒ**ï¼šè‡ªåŠ¨é‡è¯•æé«˜æˆåŠŸç‡
- âœ… **å¯ç›‘æ§æ€§**ï¼šå®Œæ•´çš„æ€§èƒ½æŒ‡æ ‡
- âœ… **å®‰å…¨æ€§**ï¼šç»Ÿä¸€çš„tokenç®¡ç†
- âœ… **å¯ç»´æŠ¤æ€§**ï¼šè¯·æ±‚è‡ªåŠ¨å–æ¶ˆé¿å…å†…å­˜æ³„æ¼

### 2. ç»„ä»¶å±‚é¢
- âœ… **å¯å¤ç”¨æ€§**ï¼šé€šç”¨ç»„ä»¶å¯åœ¨å¤šå¤„ä½¿ç”¨
- âœ… **å¯ç»´æŠ¤æ€§**ï¼šæ¸…æ™°çš„Propså’ŒEmitså®šä¹‰
- âœ… **å¯æ‰©å±•æ€§**ï¼šæ’æ§½æœºåˆ¶æä¾›çµæ´»æ€§
- âœ… **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„TypeScriptç±»å‹
- âœ… **æ–‡æ¡£å®Œå–„**ï¼šæ¯ä¸ªç»„ä»¶éƒ½æœ‰ä½¿ç”¨è¯´æ˜

### 3. ä»£ç ç»„ç»‡
- âœ… **é€»è¾‘å¤ç”¨**ï¼šComposablesé¿å…ä»£ç é‡å¤
- âœ… **å…³æ³¨ç‚¹åˆ†ç¦»**ï¼šä¸šåŠ¡é€»è¾‘å’ŒUIåˆ†ç¦»
- âœ… **æ˜“äºæµ‹è¯•**ï¼šçº¯å‡½æ•°ä¾¿äºå•å…ƒæµ‹è¯•
- âœ… **å¼€å‘æ•ˆç‡**ï¼šå¸¸ç”¨åŠŸèƒ½å¼€ç®±å³ç”¨

---

## ğŸ“ æœ€ä½³å®è·µ

### 1. ä½¿ç”¨è¯·æ±‚Hookç®€åŒ–ç»„ä»¶

**ä¼˜åŒ–å‰ï¼š**
```vue
<script setup>
const loading = ref(false)
const error = ref(null)
const albums = ref([])

async function loadAlbums() {
  loading.value = true
  try {
    albums.value = await getAlbumList()
  } catch (err) {
    error.value = err
  } finally {
    loading.value = false
  }
}
</script>
```

**ä¼˜åŒ–åï¼š**
```vue
<script setup>
const { data: albums, loading, error, execute } = useRequest(getAlbumList)
execute()
</script>
```

### 2. ä½¿ç”¨ç»„ä»¶å°è£…å‡å°‘é‡å¤ä»£ç 

**ä¼˜åŒ–å‰ï¼š**
```vue
<template>
  <div class="album-card">
    <img :src="album.coverUrl" />
    <h4>{{ album.title }}</h4>
    <p>{{ album.artist }}</p>
    <!-- å¤§é‡é‡å¤çš„HTMLå’Œæ ·å¼ -->
  </div>
</template>
```

**ä¼˜åŒ–åï¼š**
```vue
<template>
  <AlbumCard :album="album" @click="handleClick" />
</template>
```

### 3. ä½¿ç”¨Composablesæå–é€»è¾‘

**ä¼˜åŒ–å‰ï¼š**
```vue
<script setup>
// æ¯ä¸ªç»„ä»¶éƒ½è¦å†™ä¸€éé˜²æŠ–é€»è¾‘
let timer
function search(keyword) {
  clearTimeout(timer)
  timer = setTimeout(() => {
    // æœç´¢é€»è¾‘
  }, 500)
}
</script>
```

**ä¼˜åŒ–åï¼š**
```vue
<script setup>
const { search, results } = useSearch(searchAlbums)
</script>
```

---

## ğŸ”„ ç»„ä»¶å¸è½½æ—¶çš„æ¸…ç†

æ‰€æœ‰è¯·æ±‚ä¼šåœ¨ç»„ä»¶å¸è½½æ—¶è‡ªåŠ¨å–æ¶ˆï¼Œé¿å…å†…å­˜æ³„æ¼ï¼š

```typescript
// useRequest è‡ªåŠ¨å¤„ç†
const { execute } = useRequest(fetchData, {
  autoCancelOnUnmount: true // é»˜è®¤ä¸ºtrue
})

// æ‰‹åŠ¨å–æ¶ˆæ‰€æœ‰è¯·æ±‚
import { cancelAllRequests } from '@/api/request'
onUnmounted(() => {
  cancelAllRequests()
})
```

---

## ğŸ“Š æ€§èƒ½ç›‘æ§

æŸ¥çœ‹è¯·æ±‚æ€§èƒ½æ•°æ®ï¼š

```typescript
import { 
  getRequestMetrics,
  getAverageRequestDuration,
  getRequestSuccessRate 
} from '@/api/request'

// è·å–æ‰€æœ‰è¯·æ±‚è®°å½•
const metrics = getRequestMetrics()

// å¹³å‡è¯·æ±‚æ—¶é•¿
console.log('å¹³å‡æ—¶é•¿:', getAverageRequestDuration(), 'ms')

// è¯·æ±‚æˆåŠŸç‡
console.log('æˆåŠŸç‡:', getRequestSuccessRate(), '%')
```

---

## ğŸš€ ä½¿ç”¨å»ºè®®

### å¼€å‘æ–°åŠŸèƒ½æ—¶

1. **å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰å¯å¤ç”¨çš„ç»„ä»¶**
   - æŸ¥çœ‹ `components/common/README.md`
   - æŸ¥çœ‹ `components/business/README.md`

2. **ä¼˜å…ˆä½¿ç”¨Composables**
   - è¯·æ±‚ç›¸å…³ï¼šuseRequestã€usePagination
   - æœç´¢ç›¸å…³ï¼šuseSearchã€useDebounce
   - UIç›¸å…³ï¼šuseDialogã€useClipboard

3. **æ–°å»ºç»„ä»¶éµå¾ªè§„èŒƒ**
   - å®šä¹‰å®Œæ•´çš„Propså’ŒEmitsç±»å‹
   - æ·»åŠ JSDocæ–‡æ¡£æ³¨é‡Š
   - æä¾›ä½¿ç”¨ç¤ºä¾‹
   - è€ƒè™‘æ’æ§½æ‰©å±•æ€§

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **åˆ©ç”¨è¯·æ±‚ç¼“å­˜**
   - GETè¯·æ±‚è‡ªåŠ¨ç¼“å­˜5åˆ†é’Ÿ
   - å‡å°‘ä¸å¿…è¦çš„ç½‘ç»œè¯·æ±‚

2. **é¿å…é‡å¤è¯·æ±‚**
   - è‡ªåŠ¨å–æ¶ˆé‡å¤çš„pendingè¯·æ±‚
   - é˜²æŠ–å¤„ç†ç”¨æˆ·è¾“å…¥

3. **ç»„ä»¶æ‡’åŠ è½½**
   - ä½¿ç”¨åŠ¨æ€import
   - è·¯ç”±å·²é…ç½®æ‡’åŠ è½½

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¼€å‘æŒ‡å—.md](./å¼€å‘æŒ‡å—.md) - è¯¦ç»†çš„å¼€å‘è§„èŒƒ
- [README.md](./README.md) - é¡¹ç›®è¯´æ˜
- [components/common/README.md](./src/components/common/README.md) - é€šç”¨ç»„ä»¶æ–‡æ¡£
- [components/business/README.md](./src/components/business/README.md) - ä¸šåŠ¡ç»„ä»¶æ–‡æ¡£

---

## âœ… ç¬¦åˆcursorrulesçš„è¦æ±‚

### ç½‘ç»œè¯·æ±‚è§„èŒƒ
- âœ… ä½¿ç”¨ç»Ÿä¸€çš„HTTPå®¢æˆ·ç«¯ï¼ˆaxiosï¼‰
- âœ… å®ç°è¯·æ±‚æ‹¦æˆªå™¨ï¼Œè‡ªåŠ¨æ·»åŠ è®¤è¯tokenå’Œå…¬å…±å‚æ•°
- âœ… å®ç°å“åº”æ‹¦æˆªå™¨ï¼Œç»Ÿä¸€å¤„ç†é”™è¯¯ç å’Œå¼‚å¸¸æƒ…å†µ
- âœ… æ‰€æœ‰APIè¯·æ±‚ä½¿ç”¨TypeScriptæ¥å£å®šä¹‰
- âœ… å®ç°è¯·æ±‚é‡è¯•æœºåˆ¶
- âœ… ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†APIç«¯ç‚¹
- âœ… å®ç°è¯·æ±‚å–æ¶ˆåŠŸèƒ½ï¼Œé¿å…å†…å­˜æ³„æ¼
- âœ… å®ç°è¯·æ±‚ç¼“å­˜æœºåˆ¶
- âœ… ç›‘æ§è¯·æ±‚æ€§èƒ½ï¼Œè®°å½•è¯·æ±‚è€—æ—¶å’ŒæˆåŠŸç‡

### ç»„ä»¶å°è£…è§„èŒƒ
- âœ… éµå¾ªå•ä¸€èŒè´£åŸåˆ™
- âœ… ä½¿ç”¨Propsè¿›è¡Œæ•°æ®ä¼ é€’
- âœ… ä½¿ç”¨Emitsè¿›è¡Œäº‹ä»¶é€šä¿¡
- âœ… å®ç°æ’æ§½(Slot)æœºåˆ¶
- âœ… ä¸ºç»„ä»¶æä¾›å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- âœ… å®ç°ç»„ä»¶æ–‡æ¡£ï¼ŒåŒ…æ‹¬Propsã€Emitsã€Slotsè¯´æ˜
- âœ… éµå¾ªå‘½åè§„èŒƒ
- âœ… ä¸ºç»„ä»¶æä¾›é»˜è®¤æ ·å¼å’Œä¸»é¢˜å®šåˆ¶èƒ½åŠ›

---

**æ¶æ„ä¼˜åŒ–å®Œæˆï¼ç°åœ¨é¡¹ç›®å…·å¤‡äº†ä¼ä¸šçº§çš„ä»£ç è´¨é‡å’Œå¼€å‘ä½“éªŒï¼** ğŸ‰

